<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lam">

<title>Risk of outbreaks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ro_ref_files/libs/clipboard/clipboard.min.js"></script>
<script src="ro_ref_files/libs/quarto-html/quarto.js"></script>
<script src="ro_ref_files/libs/quarto-html/popper.min.js"></script>
<script src="ro_ref_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ro_ref_files/libs/quarto-html/anchor.min.js"></script>
<link href="ro_ref_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ro_ref_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ro_ref_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ro_ref_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ro_ref_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#giới-thiệu" id="toc-giới-thiệu" class="nav-link active" data-scroll-target="#giới-thiệu"><span class="header-section-number">1</span> Giới thiệu</a></li>
  <li><a href="#các-bước-đọc-và-so-sánh-chênh-lệch-dữ-liệu" id="toc-các-bước-đọc-và-so-sánh-chênh-lệch-dữ-liệu" class="nav-link" data-scroll-target="#các-bước-đọc-và-so-sánh-chênh-lệch-dữ-liệu"><span class="header-section-number">2</span> Các bước đọc và so sánh chênh lệch dữ liệu</a>
  <ul class="collapse">
  <li><a href="#đọc-dữ-liệu-với-notepad" id="toc-đọc-dữ-liệu-với-notepad" class="nav-link" data-scroll-target="#đọc-dữ-liệu-với-notepad"><span class="header-section-number">2.1</span> Đọc dữ liệu với Notepad</a></li>
  <li><a href="#đọc-dữ-liệu-vào-r" id="toc-đọc-dữ-liệu-vào-r" class="nav-link" data-scroll-target="#đọc-dữ-liệu-vào-r"><span class="header-section-number">2.2</span> Đọc dữ liệu vào R</a>
  <ul class="collapse">
  <li><a href="#các-package-cần-thiết" id="toc-các-package-cần-thiết" class="nav-link" data-scroll-target="#các-package-cần-thiết"><span class="header-section-number">2.2.1</span> Các package cần thiết</a></li>
  <li><a href="#tải-và-gán-dữ-liệu-vào-r" id="toc-tải-và-gán-dữ-liệu-vào-r" class="nav-link" data-scroll-target="#tải-và-gán-dữ-liệu-vào-r"><span class="header-section-number">2.2.2</span> Tải và gán dữ liệu vào R</a></li>
  <li><a href="#sử-dụng-hàm-for-để-tìm-tiêu-đề" id="toc-sử-dụng-hàm-for-để-tìm-tiêu-đề" class="nav-link" data-scroll-target="#sử-dụng-hàm-for-để-tìm-tiêu-đề"><span class="header-section-number">2.2.3</span> Sử dụng hàm <em>for</em> để tìm tiêu đề</a></li>
  <li><a href="#tổng-hợp-các-nguồn" id="toc-tổng-hợp-các-nguồn" class="nav-link" data-scroll-target="#tổng-hợp-các-nguồn"><span class="header-section-number">2.2.4</span> Tổng hợp các nguồn</a></li>
  <li><a href="#xuất-dữ-liệu-thành-file-excel" id="toc-xuất-dữ-liệu-thành-file-excel" class="nav-link" data-scroll-target="#xuất-dữ-liệu-thành-file-excel"><span class="header-section-number">2.2.5</span> Xuất dữ liệu thành file excel</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Risk of outbreaks</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lam </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="giới-thiệu" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Giới thiệu</h1>
<p>Nghiên cứu được thực hiện từ tháng 11.2023 thu thập được tổng cộng 9,797 nghiên cứu. Bổ sung thêm các nghiên cứu từ tháng 11.2023 đến tháng 07.2024 trên 5 nguồn cơ sở dữ liệu, bao gồm:</p>
<table class="table">
<thead>
<tr class="header">
<th>Nguồn</th>
<th>11.2023</th>
<th>07.2024</th>
<th>Chênh lệch</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Embase (Ovid)</td>
<td>2,883</td>
<td>2,998</td>
<td>115</td>
</tr>
<tr class="even">
<td>ScienceDirect</td>
<td>887</td>
<td>949</td>
<td>62</td>
</tr>
<tr class="odd">
<td>PubMed</td>
<td>3,448</td>
<td>3,555</td>
<td>107</td>
</tr>
<tr class="even">
<td>Web of Science</td>
<td>2,546</td>
<td>2,744</td>
<td>198</td>
</tr>
<tr class="odd">
<td>Cochrane Library</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="các-bước-đọc-và-so-sánh-chênh-lệch-dữ-liệu" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Các bước đọc và so sánh chênh lệch dữ liệu</h1>
<p>Dữ liệu nghiên cứu từ các nguồn được tải về dưới dạng Research Information Systems Document (.ris) hoặc NBIB File (.nbib).</p>
<section id="đọc-dữ-liệu-với-notepad" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="đọc-dữ-liệu-với-notepad"><span class="header-section-number">2.1</span> Đọc dữ liệu với Notepad</h2>
<p><img src="notepad.jpeg" class="img-fluid"></p>
<p>Mỗi tệp dữ liệu từ các nguồn khác nhau sẽ có ký tự viết tắt khác nhau, các từ khóa tập trung:</p>
<ul>
<li><p><strong>Title (tiêu đề):</strong> T1, TI, …</p></li>
<li><p><strong>Author (tác giả):</strong> A1, …</p></li>
<li><p><strong>Keyword (từ khóa):</strong> KW, …</p></li>
<li><p><strong>DOI:</strong> DO, …</p></li>
</ul>
</section>
<section id="đọc-dữ-liệu-vào-r" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="đọc-dữ-liệu-vào-r"><span class="header-section-number">2.2</span> Đọc dữ liệu vào R</h2>
<section id="các-package-cần-thiết" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="các-package-cần-thiết"><span class="header-section-number">2.2.1</span> Các package cần thiết</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tải-và-gán-dữ-liệu-vào-r" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="tải-và-gán-dữ-liệu-vào-r"><span class="header-section-number">2.2.2</span> Tải và gán dữ liệu vào R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ris <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">riskoutbreak</span><span class="sc">\\</span><span class="st">quarto</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">jul24</span><span class="sc">\\</span><span class="st">ris.ris"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Có thể thấy được từ dữ liệu dạng text trên Notepad, tiêu đề của cơ sở dữ liệu Embase được ký hiệu là T1, vậy nên để lọc được tiêu đề từ file text trên nhóm nghiên cứu cần tìm các dòng có chứa ký tự “T1”.</p>
<p>Các ký tự của tiêu đề bao gồm số + “.”. VD: “1.”, “100.”, …</p>
<p>Sử dụng hàm <em>paste0()</em> để tạo ra chuỗi ký tự (đặt tên là id) và tìm trong toàn bộ text. Sau đó khởi chạy có cho ra kết quả phải là tiêu đề hay không.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="st">". "</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ris <span class="sc">%in%</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 FALSE   TRUE 
118693    100 </code></pre>
</div>
</div>
<p>Kết quả bên trên cho thấy trong tổng số dòng, có 100 dòng cho ra kết quả là <strong>TRUE</strong> và còn lại là <strong>FALSE</strong>. Tương tự, tệp dữ liệu này được tải với 2000 nghiên cứu nên chọn id là từ 1 đến 2000.</p>
</section>
<section id="sử-dụng-hàm-for-để-tìm-tiêu-đề" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="sử-dụng-hàm-for-để-tìm-tiêu-đề"><span class="header-section-number">2.2.3</span> Sử dụng hàm <em>for</em> để tìm tiêu đề</h3>
<ul>
<li><p>Đặt lại biến <em>id</em> từ 1 đến 3000 (có tổng cộng 2998 nghiên cứu).</p></li>
<li><p>Tạo ra biến <em>nr</em> để tìm các dòng có chứa ký tự cần tìm “T1”.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3000</span>, <span class="st">". "</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="fu">which</span>(ris <span class="sc">%in%</span> id)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(nr) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  l[[i]] <span class="ot">&lt;-</span> ris[nr[i]<span class="sc">:</span>(nr[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">4</span>)]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  title <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"T1"</span>, <span class="at">x =</span> l[[i]], <span class="at">value =</span> T)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  author <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"A1"</span>, <span class="at">x =</span> l[[i]], <span class="at">value =</span> T), <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">title =</span> title, <span class="at">author =</span> author)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  l[[i]] <span class="ot">&lt;-</span> df</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind.fill</span>(l)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>title <span class="sc">%like%</span> <span class="st">"^T1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
    8  1999 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">99</span>, <span class="dv">224</span>, <span class="dv">264</span>, <span class="dv">306</span>, <span class="dv">476</span>, <span class="dv">530</span>, <span class="dv">1649</span>, <span class="dv">1425</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Giải thích:</strong></p>
<ul>
<li><p>Tạo biến <em>l</em> là một list trống.</p></li>
<li><p>Cho hàm <em>for</em> chạy vòng lặp từ 1 đến độ dài của biến <em>nr</em>.</p></li>
<li><p>Mỗi lần chạy giá trị được gán vào trong list là kết quả của 1 nghiên cứu và trừ đi 4 ký tự do có 4 ký tự trống trong file text.</p></li>
<li><p>Tiêu đề được tách ra với pattern = “T1” và tác giả với pattern = “A1”.</p></li>
<li><p>Sau cùng được lưu lại dưới dạng data frame với 2 cột tiêu đề và tác giả.</p></li>
<li><p>Check lại cột title có bắt đầu bằng “T1” không bằng cách sử dụng <em>%like%</em> từ package <em>data.table.</em></p></li>
<li><p>Phát hiện sự trùng lắp khi lọc từ code, hiện ra các ký tự khác ngoài “T1” như “KW”, “N2”, … nên loại nhưng còn khá thủ công. Có thể viết code các dòng nào không bắt đầu bằng “T1” thì xóa luôn từ bước tạo dataframe.</p></li>
</ul>
<p>Lặp lại tương tự với dữ liệu của tháng 11.2023.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Embase July 24 (2)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ris <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">riskoutbreak</span><span class="sc">\\</span><span class="st">quarto</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">jul24</span><span class="sc">\\</span><span class="st">ris (1).ris"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3000</span>, <span class="st">". "</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="fu">which</span>(ris <span class="sc">%in%</span> id)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(nr) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  l[[i]] <span class="ot">&lt;-</span> ris[nr[i]<span class="sc">:</span>(nr[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">4</span>)]</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  title <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"T1"</span>, <span class="at">x =</span> l[[i]], <span class="at">value =</span> T)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  author <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"A1"</span>, <span class="at">x =</span> l[[i]], <span class="at">value =</span> T), <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">title =</span> title, <span class="at">author =</span> author)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  l[[i]] <span class="ot">&lt;-</span> df1</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">rbind.fill</span>(l)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df1<span class="sc">$</span>title <span class="sc">%like%</span> <span class="st">"^T1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
    9   997 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df1[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">807</span>, <span class="dv">886</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">671</span>, <span class="dv">34</span>, <span class="dv">499</span>, <span class="dv">29</span>), ]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="do">#######</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Embase Nov 23 (1)</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>ris <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">riskoutbreak</span><span class="sc">\\</span><span class="st">quarto</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">nov23</span><span class="sc">\\</span><span class="st">ro-embase-1.ris"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>, <span class="st">". "</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="fu">which</span>(ris <span class="sc">%in%</span> id)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(nr) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  l[[i]] <span class="ot">&lt;-</span> ris[nr[i]<span class="sc">:</span>(nr[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">4</span>)]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  title <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"T1"</span>, <span class="at">x =</span> l[[i]], <span class="at">value =</span> T)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  author <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"A1"</span>, <span class="at">x =</span> l[[i]], <span class="at">value =</span> T), <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  df3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">title =</span> title, <span class="at">author =</span> author)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  l[[i]] <span class="ot">&lt;-</span> df3</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">rbind.fill</span>(l)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df3<span class="sc">$</span>title <span class="sc">%like%</span> <span class="st">"^T1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
   11  1999 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df3[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">213</span>, <span class="dv">279</span>, <span class="dv">334</span>, <span class="dv">1477</span>, <span class="dv">1870</span>, <span class="dv">1871</span>, <span class="dv">1252</span>, <span class="dv">1867</span>, <span class="dv">1868</span>, <span class="dv">1866</span>), ]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Embase Nov 23 (2)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>ris <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">riskoutbreak</span><span class="sc">\\</span><span class="st">quarto</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">nov23</span><span class="sc">\\</span><span class="st">ro-embase-2.ris"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3000</span>, <span class="st">". "</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="fu">which</span>(ris <span class="sc">%in%</span> id)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(nr) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  l[[i]] <span class="ot">&lt;-</span> ris[nr[i]<span class="sc">:</span>(nr[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">4</span>)]</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  title <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"T1"</span>, <span class="at">x =</span> l[[i]], <span class="at">value =</span> T)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  author <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"A1"</span>, <span class="at">x =</span> l[[i]], <span class="at">value =</span> T), <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  df4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">title =</span> title, <span class="at">author =</span> author)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  l[[i]] <span class="ot">&lt;-</span> df4</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">rbind.fill</span>(l)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df4<span class="sc">$</span>title <span class="sc">%like%</span> <span class="st">"^T1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
    4   832 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> df4[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">637</span>, <span class="dv">716</span>, <span class="dv">501</span>, <span class="dv">327</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tổng-hợp-các-nguồn" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="tổng-hợp-các-nguồn"><span class="header-section-number">2.2.4</span> Tổng hợp các nguồn</h3>
<p>Tại đây, tổng hợp dữ liệu theo tháng lại thành cùng một dataframe bằng cách sử dụng hàm <em>union_all().</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>em_jul <span class="ot">&lt;-</span> <span class="fu">union_all</span>(df, df1)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>em_nov <span class="ot">&lt;-</span> <span class="fu">union_all</span>(df3, df4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sau đó, sử dụng <em>set_diff()</em> để tìm ra những nghiên cứu không bị trùng trong dataframe dữ liệu tháng 07.2024.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(em_jul, em_nov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="xuất-dữ-liệu-thành-file-excel" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="xuất-dữ-liệu-thành-file-excel"><span class="header-section-number">2.2.5</span> Xuất dữ liệu thành file excel</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(a, <span class="st">"embase_danhsach.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>